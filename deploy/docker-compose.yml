services:
  # 后端服务 - Deep Research Agent
  deep-research-agent:
    build:
      context: ../
      dockerfile: agents/deep-research/Dockerfile
    container_name: deep-research-agent
    ports:
      - "8000:8000"
    environment:
      # 包含 agent-core 源码路径以支持 libs 的热重载 (配合 volumes 挂载)
      - PYTHONPATH=/app/agents/deep-research/src:/app/libs/agent-core/src
    env_file:
      - ../agents/deep-research/.env
    volumes:
      - ../agents/deep-research/src:/app/agents/deep-research/src
      - ../libs:/app/libs
    restart: unless-stopped


  # 前端服务
  frontend:
    build:
      context: ../
      dockerfile: agents/deep-research/Dockerfile.frontend
    container_name: deep-research-frontend
    ports:
      - "3000:80"
    depends_on:
      - deep-research-agent
    volumes:
      - ../agents/deep-research/html:/usr/share/nginx/html
    restart: unless-stopped
