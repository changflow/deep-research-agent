services:
  # 后端服务 - Deep Research Agent
  deep-research-agent:
    build:
      context: ../
      dockerfile: agents/deep-research/Dockerfile
    container_name: deep-research-agent
    ports:
      - "8000:8000"
    environment:
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - OPENAI_BASE_URL=${OPENAI_BASE_URL}
      - LLM_MODEL=${LLM_MODEL:-gpt-4o}
      - TAVILY_API_KEY=${TAVILY_API_KEY}
      - LANGFUSE_PUBLIC_KEY=${LANGFUSE_PUBLIC_KEY}
      - LANGFUSE_SECRET_KEY=${LANGFUSE_SECRET_KEY}
      - LANGFUSE_HOST=${LANGFUSE_HOST}
    env_file:
      - ../agents/deep-research/.env
    volumes:
      - ../agents/deep-research/src:/app/agents/deep-research/src
      - ../libs:/app/libs
    restart: unless-stopped


  # 前端服务
  frontend:
    build:
      context: ../
      dockerfile: agents/deep-research/Dockerfile.frontend
    container_name: deep-research-frontend
    ports:
      - "3000:80"
    depends_on:
      - deep-research-agent
    restart: unless-stopped
